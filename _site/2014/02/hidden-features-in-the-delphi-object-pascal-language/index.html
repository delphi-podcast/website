<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=8dce9d32f790087ba98d18ab087bc3f67f3d9fc2">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Hidden features in the Delphi Object Pascal language | The Podcast at Delphi.org</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Hidden features in the Delphi Object Pascal language" />
<meta name="author" content="Jim McKeeth" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A list of hidden features in Delphi Object Pascal that are great, obscure, best avoided or remarkable." />
<meta property="og:description" content="A list of hidden features in Delphi Object Pascal that are great, obscure, best avoided or remarkable." />
<link rel="canonical" href="http://localhost:4000/2014/02/hidden-features-in-the-delphi-object-pascal-language/" />
<meta property="og:url" content="http://localhost:4000/2014/02/hidden-features-in-the-delphi-object-pascal-language/" />
<meta property="og:site_name" content="The Podcast at Delphi.org" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-02-20T15:19:01-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hidden features in the Delphi Object Pascal language" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jim McKeeth"},"dateModified":"2014-02-20T15:19:01-07:00","datePublished":"2014-02-20T15:19:01-07:00","description":"A list of hidden features in Delphi Object Pascal that are great, obscure, best avoided or remarkable.","headline":"Hidden features in the Delphi Object Pascal language","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2014/02/hidden-features-in-the-delphi-object-pascal-language/"},"url":"http://localhost:4000/2014/02/hidden-features-in-the-delphi-object-pascal-language/"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>delphiorg.github.io</h1>
        </a>
        <h2>The Podcast about the Delphi programming language, tools, news and community.</h2>

        <section id="downloads">
          
          <a href="https://github.com/delphiorg/delphiorg.github.io" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <small>20 February 2014</small>
<h1>Hidden features in the Delphi Object Pascal language</h1>

<p class="view">by Jim McKeeth</p>

<p>A list of hidden features in Delphi Object Pascal that are great, obscure, best avoided or remarkable.</p>

<p>This was copied from <a href="http://stackoverflow.com/questions/6063274/hidden-features-in-the-delphi-language">Stack Overflow’s question of the same name</a> which is closed and flagged for deletion. Licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc by-sa 3.0</a> with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>. I’ve made a few changes, updates and some copy editing. Original question by <a href="http://stackoverflow.com/users/650492/johan">Johan</a> and others on <a href="http://stackoverflow.com/revisions/6063274/1">May 19 2011 at 18:34</a>. Post inspired by <a href="http://wiert.me/2014/02/20/hidden-features-in-delphi-related-topics-from-stackoverflow-until-the-diamond-moderators-kill-these-too/">Jeroen W. Pluimers’</a> post.</p>

<!--more-->

<hr />

<p><a href="http://stackoverflow.com/users/121689">David M</a> added:</p>

<p>My favourite (although I don’t know if I have ever written code that uses this) is how you can <a href="http://docwiki.embarcadero.com/RADStudio/en/Using_Implements_for_Delegation"><strong>delegate implementation of an interface ‘supported’ by a class to one of the class’s properties</strong></a>. In a pure OO design sense, I don’t know if this is awful or beautiful - you’re basically lying about what your class’s methods are - but in a code cleanliness and separation sense it’s awesome.</p>

<p>For example (untested, written from memory):</p>

<p>[delphi]type
IFoo = interface
[‘{3F996D68-1FD0-4490-AE60-8F735A9DFFE8}’]
    function TheQueensHead: Byte; // Geddit?  They’re bars 
    function TheBoar: Byte;
    function TeeFortyTwo: Byte;
  end;&lt;/p&gt;
&lt;p&gt;TOnTheTown = class(TInterfacedObject, IFoo)
  private
    FFoo: TFoo; // Some class that actually concretely implements IFoo
  public
    constructor Create();
    property Foo: TFoo read FFoo implements IFoo; // This keyword is the awesome one
  end;[/delphi]</p>

<p>Now, if I remember my Delphi correctly (I mostly use C++ these days) you can call:</p>

<p>[delphi]Party := TOnTheTown.Create();
Party.TheBoar;[/delphi]</p>

<p>where <code>TheBoar</code> is shown in the class declaration as implemented by that class, but code-wise you implement it in the class that the property <code>Foo</code> is of - the call is delegated to the property. Neat, isn’t it?</p>

<p>Even better, I just learned this very day while googling to check my memory was correct that starting with XE, <a href="http://docwiki.embarcadero.com/RADStudio/en/Property_Implements_Support_for_C++Builder">you can do this in C++ too</a>.</p>

<p>Either declare Party as IFoo or, perhaps, cast it (Party as IFoo). The point is that you have an object that you state implements various methods (because it claims to implement a particular interface) and yet it doesn’t - calls are redirected / delegated somewhere else.</p>

<hr />

<p><a href="http://stackoverflow.com/users/282848/andreas-rejbrand">Andreas Rejbrand</a> added:</p>

<p>You can use <strong>&amp;</strong> to prefix identifiers that would normally be invalid because they are reserved words.</p>

<p>[delphi]procedure TForm1.Button1Click(Sender: TObject);
var
  &amp;amp;begin,
  &amp;amp;if,
  &amp;amp;end: integer;
begin
  &amp;amp;begin := 10;
  &amp;amp;if := 100;
  &amp;amp;end := 1000;
  ShowMessage(IntToStr(&amp;amp;begin + &amp;amp;if + &amp;amp;end));
end;[/delphi]</p>

<p>You can use the <strong>^A</strong> syntax to denote a <strong>Ctrl+A</strong> ‘character’:</p>

<p>[delphi]procedure TForm1.FormKeyPress(Sender: TObject; var Key: Char);
begin
  if Key = ^C then
    ShowMessage(‘The user wants to copy something.’)
  else if Key = ^V then
    ShowMessage(‘The user wants to paste.’)
end;[/delphi]</p>

<p>Something I have always found a bit funny is the compiler magic associated with the TGUID type. This is declared as</p>

<p>[delphi]TGUID = packed record
  D1: LongWord;
  D2: Word;
  D3: Word;
  D4: array[0..7] of Byte;
end;[/delphi]
and so, <emphasis>a priori</emphasis>, one would not expect something naïve like</p>

<p>[delphi light=”true”]const
  g: TGUID = ‘{E4C26C63-CDD1-4450-9FE0-6F035E33CF90}’;[/delphi]
to work, but it does. Compiler magic, it is!</p>

<p>One would expect</p>

<pre>[DCC Error] Unit1.pas(27): E2010 Incompatible types: 'TGUID' and 'string'</pre>

<hr />

<p><a href="http://stackoverflow.com/users/243614/sertac-akyuz">Sertac Akyuz</a> added:</p>

<p>Construct a dynamic array using it’s type’s constructor:</p>

<p>[delphi]type
  TInts = array of Integer;</p>

<p>..</p>

<p>var
  Ints: TInts;
begin
  Ints := TInts.Create(3, 5, 1, 0, -2, 5);
end;[/delphi]</p>

<p>Not sure if this is documented or not but when I learned this from a newsgroup post after years of using Delphi, I was a bit surprised.</p>

<p>PS: Do not <strong>Free</strong> the array. :)</p>

<hr />

<p><a href="http://stackoverflow.com/users/282676">Cosmin Prund</a> brought up <strong>The ABSOLUTE keyword</strong>.</p>

<p>This is a nice way to shoot yourself in the foot, because it throws type-safety out the window big time. Delphi’s RTL sources uses this in 5 different units. The first 4 only use it once per unit, then there’s Mxarrays.pas where this is used 22 times. What I’m trying to say is that the absolute keyword is rarely used.</p>

<p>[delphi]// This is how it’s useful:
procedure Test;
var i64: Int64;
    b:array[0..7] of Byte absolute i64; // starts at the same memory space as i64
begin
  i64 := 7;
  WriteLn(b[3]);
end;</p>

<p>// This is how you shoot yourself in the foot:
procedure Test;
var s: string;
    i: NativeInt absolute s;
begin
  s := ‘Test’;
  Dec(i, 7);
  ShowMessage(s); // will give you garbage or AV
end;[/delphi]</p>

<p><strong>Variant records</strong> are weired-looking records where some part of the record is “variable”. Every time I see one used I say That’s an useful trick, but never managed to actually use one in my own code. And I do use weird unsafe things like the absolute keyword and pointer arithmetic.</p>

<p>Example:</p>

<p>[delphi]type
  TKindOfShape = (ksCircle, ksSquare);</p>

<p>Shape = record
    case Kind:TKindOfShape of
      ksCircle:
        (
          R: Double;
          CenterX, CenterY: Double;
        );
      ksSquare:
        (
          Top, Left, SideSize: Double;
        );
  end;[/delphi]</p>

<hr />

<p><a href="http://stackoverflow.com/users/84704/warren-p">Warren Postma</a> brought in some ancient syntax:</p>

<p>Not so much hidden, as ancient are the digraphs supported by the original Wirth pascal, which still work in Delphi:</p>

<p>[delphi]procedure Dummy;
var
   a:array (. 0 .. 2 .) of Integer;
begin</p>

<p>end;[/delphi]
The character sequence (. and .) replace [ and ] on systems where the [ and ] are not even available, and are called digraphs because they are two characters. C/C++ for example, supports some Trigraphs (three character symbols), too.</p>

<p>I think most Delphi programmers have seen comments that are written with (* and *) which are the common digraph form of { and }.</p>

<hr />

<p><a href="http://stackoverflow.com/users/30176/lkessler">lkessler</a> added:</p>

<p>Almost everyone knows about the <strong>inc</strong>rement and <strong>dec</strong>rement function:</p>

<p>[delphi light=”true”]Inc(N) // to increment N by 1.
Dec(N) // to decrement N by 1.[/delphi]
But did you know they have a second parameter, which is the amount of the increment?</p>

<p>[delphi light=”true”]Inc(N, I) // to increment N by I.
Dec(N, D) // to decrement N by D.[/delphi]
Now I think these are for people who start using Delphi after using other languages. Personally I prefer:</p>

<p>[delphi light=”true”]N := N + 1;
N := N - 1;
N := N + I;
N := N - D;[/delphi]
which generates exactly the same code as Inc and Dec do, with equivalent optimizations.</p>

<p>Don’t forget about <strong>Pred</strong> and <strong>Succ</strong>, which when applied to integers returns the value one less and one greater without changing the original value. And you can string them, e.g.</p>

<p>[delphi light=”true”]Pred(Pred(Pred(N)));[/delphi]</p>

<hr />

<p><a href="http://stackoverflow.com/users/757830">NGLN</a> points out it is possible to omit the parameter list of routines that are declared in the interface section. For functions it is even possible to omit the result type, which leads to weird looking implementations like:</p>

<p>[delphi light=”true”]function GetText(var A: Integer; const B: Char; C: Word = 0): String;</p>

<p>implementation</p>

<p>function GetText;
begin
  Result := ‘Where am I going?’;
end;[/delphi]
Obviously, this does not apply to overloaded routines. ;)</p>

<p>Sometimes when someone else’s code passes by, this is still surprising. Users would have maintenance reasons.</p>

<hr />

<p><a href="http://stackoverflow.com/users/764487/rudy-velthuis">Rudy Velthuis</a> points out that there is a calling convention called “winapi” which (at the moment, at least) is completely identical to “stdcall”?</p>

<p>Example:</p>

<p>[delphi light=”true”]function CryptReleaseContext(hProv: HCRYPTPROV; dwFlags: DWORD): BOOL; winapi;[/delphi]
This is fully equivalent to:</p>

<p>[delphi light=”true”]function CryptReleaseContext(hProv: HCRYPTPROV; dwFlags: DWORD): BOOL; stdcall;[/delphi]</p>

<hr />

<p><a href="http://stackoverflow.com/users/30176/lkessler">lkessler</a> always seems to forget about Method Overloading. Multiple routines can share the same name. The number of parameters and type of each parameter determine which will be called.</p>

<p>e.g.:</p>

<p>[delphi light=”true”]Function Multiply (A, B: integer): integer; overload;
Function Multiply (A, B: double): double; overload;[/delphi]
Early Delphi users might not know about this one because it was added in Delphi 4.</p>

<p>See: <a href="http://www.delphibasics.co.uk/RTL.asp?Name=Overload">http://www.delphibasics.co.uk/RTL.asp?Name=Overload</a></p>

<p>Also there is a nice list of new Delphi language features added since Delphi 7, along with good examples of each at: <a href="http://edn.embarcadero.com/article/34324">http://edn.embarcadero.com/article/34324</a></p>

<p>It includes:</p>

<ul>
	<li>Inlining</li>
	<li>Operator Overloading</li>
	<li>Class Helpers</li>
	<li>Strict Private</li>
	<li>Strict Protected</li>
	<li>Records with Methods</li>
	<li>Class abstract</li>
	<li>Class sealed</li>
	<li>Class const</li>
	<li>Class type</li>
	<li>Class var</li>
	<li>Class property</li>
	<li>Nested classes</li>
	<li>Final methods</li>
	<li>Sealed methods</li>
	<li>Static class methods</li>
	<li>For-in loop</li></ul>
<hr />

<p><a href="http://stackoverflow.com/users/267938/jorn-e-angeltveit">Jørn E. Angeltveit</a> point out that the <strong>;</strong> is used to separate statements, not end statements, so you actually don’t need the last <strong>;</strong> before <strong>end</strong>:</p>

<p>[delphi light=”true”]procedure DoNothing;
begin
  Inc(i);
  Dec(i)
end;[/delphi]
It is more convenient to add statements and move statements when they all end with the <strong>;</strong>, so I definitely wouldn’t recommend to implement this a new practice at the workplace :)</p>

<hr />

<p>What else should be on the list?</p>



  <small>tags: <em>Commentary</em> - <em>delphi</em> - <em>object pascal</em> - <em>Programming Languages</em> - <em>stackoverflow</em></small>


      </section>
    </div>
  </body>
</html>
