<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=8dce9d32f790087ba98d18ab087bc3f67f3d9fc2">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Collecting Multiple Pages of REST Results in a Single MemTable | The Podcast at Delphi.org</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Collecting Multiple Pages of REST Results in a Single MemTable" />
<meta name="author" content="Jim McKeeth" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’ve run into this a few times, where a REST Service returns results in pages, so you have to make multiple passes to get all the data. One thing I love about the RAD REST Client Library is the ability to store all the data in the FDMemTable where you can work on it. Unfortunately when you can only get part of the results that limits the functionality. Here is a simple solution to get all the pages in a single FDMemTable." />
<meta property="og:description" content="I’ve run into this a few times, where a REST Service returns results in pages, so you have to make multiple passes to get all the data. One thing I love about the RAD REST Client Library is the ability to store all the data in the FDMemTable where you can work on it. Unfortunately when you can only get part of the results that limits the functionality. Here is a simple solution to get all the pages in a single FDMemTable." />
<link rel="canonical" href="http://localhost:4000/2018/02/collecting-multiple-pages-of-rest-results-in-a-single-memtable/" />
<meta property="og:url" content="http://localhost:4000/2018/02/collecting-multiple-pages-of-rest-results-in-a-single-memtable/" />
<meta property="og:site_name" content="The Podcast at Delphi.org" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-14T19:49:36-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Collecting Multiple Pages of REST Results in a Single MemTable" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jim McKeeth"},"dateModified":"2018-02-14T19:49:36-07:00","datePublished":"2018-02-14T19:49:36-07:00","description":"I’ve run into this a few times, where a REST Service returns results in pages, so you have to make multiple passes to get all the data. One thing I love about the RAD REST Client Library is the ability to store all the data in the FDMemTable where you can work on it. Unfortunately when you can only get part of the results that limits the functionality. Here is a simple solution to get all the pages in a single FDMemTable.","headline":"Collecting Multiple Pages of REST Results in a Single MemTable","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2018/02/collecting-multiple-pages-of-rest-results-in-a-single-memtable/"},"url":"http://localhost:4000/2018/02/collecting-multiple-pages-of-rest-results-in-a-single-memtable/"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>delphiorg.github.io</h1>
        </a>
        <h2>The Podcast about the Delphi programming language, tools, news and community.</h2>

        <section id="downloads">
          
          <a href="https://github.com/delphiorg/delphiorg.github.io" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <small>14 February 2018</small>
<h1>Collecting Multiple Pages of REST Results in a Single MemTable</h1>

<p class="view">by Jim McKeeth</p>

<p>I’ve run into this a few times, where a REST Service returns results in pages, so you have to make multiple passes to get all the data. One thing I love about the RAD REST Client Library is the ability to store all the data in the FDMemTable where you can work on it. Unfortunately when you can only get part of the results that limits the functionality. Here is a simple solution to get all the pages in a single FDMemTable.</p>

<p>What you need is a second <strong>FDMemTable</strong>. My first one is called <em>MembersTempTable</em>, and it is attached to the <strong>Response Adapter</strong>. The second one is called <em>MembersMemTable</em> and it will hold the complete set of data.</p>

<p>[delphi]
  // Drop any existing data
  MembersMemTable.Close;</p>

<p>// Get the first page 
  MembersRequest.Params.ParameterByName(‘limit’).Value := ‘50’;
  MembersRequest.Params.ParameterByName(‘offset’).Value := ‘0’;
  MembersRequest.Execute;</p>

<p>// This clones the FDMemTable
  MembersMemTable.CopyDataSet(MembersTempTable, 
    [coStructure, coRestart, coAppend]);</p>

<p>// Now we add the other tables
  MembersMemTable.BeginBatch();
  try
    // Repeat until we don’t get a full page
    while MembersTempTable.RecordCount = 50 do
    begin
      // Start with the next page
      MembersRequest.Params.ParameterByName(‘offset’).Value := 
        (MembersMemTable.RecordCount - 1).ToString;
      MembersRequest.Execute;
      // Append those records into our FDMemTable
      MembersMemTable.CopyDataSet(MembersTempTable, [coAppend]);
    end;
    MembersMemTable.IndexFieldNames := ‘id’;
  finally
    MembersMemTable.EndBatch;
  end;
[/delphi]</p>




  <small>tags: <em>News</em></small>


      </section>
    </div>
  </body>
</html>
