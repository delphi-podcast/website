<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=8dce9d32f790087ba98d18ab087bc3f67f3d9fc2">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Simple Mobile FireDAC App | The Podcast at Delphi.org</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Simple Mobile FireDAC App" />
<meta name="author" content="Jim McKeeth" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The DocWiki has a great mobile tutorial on building a mobile To Do app with FireDAC and SQLite. I find I usually build it a little differently though, so I thought I would share my code here." />
<meta property="og:description" content="The DocWiki has a great mobile tutorial on building a mobile To Do app with FireDAC and SQLite. I find I usually build it a little differently though, so I thought I would share my code here." />
<link rel="canonical" href="http://localhost:4000/2017/06/simple-mobile-firedac-app/" />
<meta property="og:url" content="http://localhost:4000/2017/06/simple-mobile-firedac-app/" />
<meta property="og:site_name" content="The Podcast at Delphi.org" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-06-06T04:07:39-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Simple Mobile FireDAC App" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jim McKeeth"},"dateModified":"2017-06-06T04:07:39-06:00","datePublished":"2017-06-06T04:07:39-06:00","description":"The DocWiki has a great mobile tutorial on building a mobile To Do app with FireDAC and SQLite. I find I usually build it a little differently though, so I thought I would share my code here.","headline":"Simple Mobile FireDAC App","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2017/06/simple-mobile-firedac-app/"},"url":"http://localhost:4000/2017/06/simple-mobile-firedac-app/"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>delphiorg.github.io</h1>
        </a>
        <h2>The Podcast about the Delphi programming language, tools, news and community.</h2>

        <section id="downloads">
          
          <a href="https://github.com/delphiorg/delphiorg.github.io" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <small>6 June 2017</small>
<h1>Simple Mobile FireDAC App</h1>

<p class="view">by Jim McKeeth</p>

<p>The DocWiki has a great mobile tutorial on <a href="http://docwiki.embarcadero.com/RADStudio/en/Mobile_Tutorial:_Using_FireDAC_and_SQLite_(iOS_and_Android)">building a mobile To Do app with FireDAC and SQLite</a>. I find I usually build it a little differently though, so I thought I would share my code here.</p>

<p>Go ahead and lay the UI out the same, and put down most of the same FireDAC components, with the visual LiveBindings. I love how it uses the LiveBindings wizard to create the data source. What I change is the code in the event handlers, but what you don’t need is the Insert and Delete FDQuery components. While that code all works, it uses an older model that doesn’t take full advantage of the amazing features of FireDAC.</p>

<p>So your form will look something like this . . .</p>

<p><img class="aligncenter size-full wp-image-2841" src="/assets/images/2017/06/FireDAC-ToDo-1.png" alt="FireDAC-ToDo-1" width="318" height="467" /></p>

<p>Add an implementation uses clause</p>

<p>[code language=”Delphi”]uses FMX.DialogService.Async, IOUtils;[/code]</p>

<p>And then your <strong>addButtonClick</strong> event handler will look like this . . .</p>

<p>[code language=”Delphi”]procedure TForm42.addButtonClick(Sender: TObject);
begin
  TDialogServiceAsync.InputQuery(‘New item’,[‘Name’], [’’],
  procedure (const AResult: TModalResult;
             const AValues: array of string)
  begin
    if (AResult = mrOK) and (Length(AValues) &gt; 0) and
       (Length(Trim(AValues[0])) &gt; 0) then
    begin
      FDQuery1.InsertRecord([AValues[0]]);
    end;
    UpdateDeleteButton;
  end);
end;[/code]</p>

<p>You’ll notice a few changes. First of all, I used an anonymous method for the async callback. Also, instead of using an entirely different insert query, I just call <em>InsertRecord</em> on the existing <em>FDQuery1</em>, passing in the value. For simple tables like this one this is so much easier. This really simplified the code in my opinion. Also instead of spreading the code to update the Delete button’s visibility all over the place I used a procedure called UpdateDeleteButton. Here is the rest of the code with a few comments.</p>

<p>[code language=”Delphi”]procedure TForm42.deleteButtonClick(Sender: TObject);
begin 
  // Again we use the built in Delete method instead of a separate
  //   Delete query. This just deletes the currently active record.
  FDQuery1.Delete;
  UpdateDeleteButton;
end;</p>

<p>procedure TForm42.FDConnection1AfterConnect(Sender: TObject);
begin
  // This makes sure our table exists, just in case the data file
  //   no longer exists. Makes the app more resilient. 
  FDQueryCreateTable.ExecSQL;
  // And let’s not assume anything about that Delete button status
  UpdateDeleteButton;
end;</p>

<p>procedure TForm42.FDConnection1BeforeConnect(Sender: TObject);
begin
  // We don’t need to use a compiler directive here, but that does
  //   mean our database file is in our documents folder, which 
  //   doesn’t make as much since for a desktop.
  {$if DEFINED(iOS) or DEFINED(ANDROID)} 
  FDConnection1.Params.Values[‘Database’] := 
    TPath.Combine(TPath.GetDocumentsPath, ‘todolist.sdb’);<br />
  {$ENDIF} 
end;</p>

<p>procedure TForm42.ListView1Click(Sender: TObject);
begin
  UpdateDeleteButton;
end;</p>

<p>procedure TForm42.UpdateDeleteButton;
begin
  deleteButton.Visible := ListView1.Selected &lt;&gt; nil;
end;
[/code]</p>

<p>The beauty of calling the <em>FDQueryCreateTable.ExecSQL</em> is that you don’t need to deploy an empty database file. It just creates an empty one the first time it runs.</p>

<p>So what do you think, is this simpler? What would you do differently?</p>



  <small>tags: <em>FireDAC</em></small>


      </section>
    </div>
  </body>
</html>
